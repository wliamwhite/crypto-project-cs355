{"ast":null,"code":"var _jsxFileName = \"/Users/liamwhite/proj/node/websocket/crypto-project-cs355/crypto_site/client/src/index.js\";\nconst server = new WebSocket('ws://localhost:8080'); // const server = new WebSocket('wss://dhmcvxkisb.execute-api.us-east-2.amazonaws.com/dev')\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './components/App.jsx'; // easily identify input and button\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst input = document.getElementById('message');\nconst send = document.getElementById('send');\nconst interval = document.getElementById('interval');\nvar unixTime = Math.floor(Date.now() / 1000); // to store subscribed datafeeds client-side\n\nlet topicList = []; // only enable button AFTER websocket connection hasbeen established\n\nstartDatafeedButton.disabled = true;\nendDatafeedButton.disabled = true; // do stuff on click\n\nstartDatafeedButton.addEventListener('click', () => {}, false);\nsend.addEventListener('click', () => {\n  const coin = input.value;\n  const type = interval.value;\n  topicList.push(input.value);\n  sendMessage(topicList);\n  requestBulkPriceHistory(coin, type);\n}); // send message when 'enter' is clicked\n\ndocument.addEventListener('keyup', e => {\n  if (e.key === 'Enter') {\n    const coin = input.value;\n    const type = interval.value;\n    topicList.push(input.value);\n    sendMessage(topicList);\n    requestBulkPriceHistory(coin, type);\n  }\n}); // enable the button upon websocket connection\n\nserver.onopen = () => {\n  startDatafeedButton.disabled = false;\n  endDatafeedButton.disabled = false;\n};\n/*\nwhen websocket client receives message (i.e. ticker & price info),\ntransform the string into an object with the imported function and\npass as props into the <App /> component\n*/\n\n\nserver.onmessage = event => {\n  console.log(\"reached onmessage\");\n  let message = JSON.parse(event.data);\n  console.log(message);\n\n  if (message.type == 'pricehistory') {\n    console.log(message.data);\n    ReactDOM.render( /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(App, {\n        type: \"history\",\n        coin: message.ticker,\n        history: message.data\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 13\n    }, this), document.getElementById('root'));\n  } else {\n    ReactDOM.render( /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(App, {\n        type: \"spot\",\n        coin: message.ticker,\n        price: message.price\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 9\n    }, this), document.getElementById('root'));\n  }\n}; // TODO: abstract & export, make topicList a tuple (no duplicates)\n// function to be called when sending a message\n\n\nfunction sendMessage(topicList) {\n  const toServer = {\n    action: 'establishKucoinWebsocket',\n    tickers: topicList\n  };\n  server.send(JSON.stringify(toServer));\n}\n\n;\n\nfunction requestBulkPriceHistory(coin, interval) {\n  const toServer = {\n    action: 'bulkPriceHistory',\n    ticker: coin,\n    start: unixTime,\n    end: unixTime,\n    type: interval\n  };\n  server.send(JSON.stringify(toServer));\n}\n\nfunction endSession() {\n  const toServer = {\n    action: 'endAllSessions',\n    tickers: topicList\n  };\n  server.send(JSON.stringify(toServer));\n}\n\n;","map":{"version":3,"sources":["/Users/liamwhite/proj/node/websocket/crypto-project-cs355/crypto_site/client/src/index.js"],"names":["server","WebSocket","React","ReactDOM","App","input","document","getElementById","send","interval","unixTime","Math","floor","Date","now","topicList","startDatafeedButton","disabled","endDatafeedButton","addEventListener","coin","value","type","push","sendMessage","requestBulkPriceHistory","e","key","onopen","onmessage","event","console","log","message","JSON","parse","data","render","ticker","price","toServer","action","tickers","stringify","start","end","endSession"],"mappings":"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","sourcesContent":["const server = new WebSocket('ws://localhost:8080');\n// const server = new WebSocket('wss://dhmcvxkisb.execute-api.us-east-2.amazonaws.com/dev')\nimport React from 'react';\nimport ReactDOM from 'react-dom'\nimport App from './components/App.jsx';\n\n// easily identify input and button\nconst input = document.getElementById('message');\nconst send = document.getElementById('send');\nconst interval = document.getElementById('interval');\n\nvar unixTime = Math.floor(Date.now() / 1000);\n\n// to store subscribed datafeeds client-side\nlet topicList = [];\n\n// only enable button AFTER websocket connection hasbeen established\nstartDatafeedButton.disabled = true;\nendDatafeedButton.disabled = true;\n\n// do stuff on click\nstartDatafeedButton.addEventListener('click', () => {\n    \n}, false);\n\nsend.addEventListener('click', () => {\n    const coin = input.value;\n    const type = interval.value;\n    topicList.push(input.value);\n    sendMessage(topicList);\n    requestBulkPriceHistory(coin, type);\n});\n\n// send message when 'enter' is clicked\ndocument.addEventListener('keyup', e => {\n    if(e.key === 'Enter'){\n        const coin = input.value;\n        const type = interval.value;\n        topicList.push(input.value);\n        sendMessage(topicList);\n        requestBulkPriceHistory(coin, type);\n    }\n});\n\n// enable the button upon websocket connection\nserver.onopen = () => {\n    startDatafeedButton.disabled = false;\n    endDatafeedButton.disabled = false;\n};\n\n/*\nwhen websocket client receives message (i.e. ticker & price info),\ntransform the string into an object with the imported function and\npass as props into the <App /> component\n*/\n\nserver.onmessage = event => {\n    console.log(\"reached onmessage\");\n    let message = JSON.parse(event.data);\n    console.log(message);\n    if(message.type == 'pricehistory'){\n        console.log(message.data);\n        ReactDOM.render(\n            <div>\n            <App\n                type='history'\n                coin={message.ticker}\n                history={message.data}\n            />\n            </div>,\n        document.getElementById('root'))\n    } else {\n        ReactDOM.render(\n        <div>\n        <App\n            type='spot'\n            coin={message.ticker}\n            price={message.price}\n        />\n        </div>,\n        document.getElementById('root'))\n    }\n};\n\n\n\n\n// TODO: abstract & export, make topicList a tuple (no duplicates)\n// function to be called when sending a message\nfunction sendMessage(topicList){\n    const toServer = {\n        action: 'establishKucoinWebsocket',\n        tickers: topicList\n    };\n    server.send(JSON.stringify(toServer));\n};\n \nfunction requestBulkPriceHistory(coin, interval) {\n    const toServer = {\n        action: 'bulkPriceHistory',\n        ticker: coin,\n        start: unixTime,\n        end: unixTime,\n        type: interval\n    };\n    server.send(JSON.stringify(toServer));\n}\n\nfunction endSession() {\n    const toServer = {\n        action: 'endAllSessions',\n        tickers: topicList\n    };\n    server.send(JSON.stringify(toServer));\n};\n"]},"metadata":{},"sourceType":"module"}